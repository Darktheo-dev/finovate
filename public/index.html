<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lucre - Login</title>
    <link rel="stylesheet" href="index.css" />

    <!-- Bootstrap (optional for styling) -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"
    />
  </head>

  <body>
    <div class="main-wrapper">
      <!-- Left box -->
      <div class="left-box">
        <img src="LUCRE_LOGO_1.png" id="logo" />
        <p id="greeting">
          <strong>Welcome to Lucre, please log in or sign up!</strong>
        </p>
      </div>

      <!-- Right box: Login card -->
      <div>
        <div
          id="loginAlert"
          class="alert alert-danger"
          style="display: none"
        ></div>

        <div class="rectangle">
          <input type="email" placeholder="Email" id="username" />
          <input type="password" placeholder="Password" id="password" />
          <button id="loginButton">Log in</button>
          <br />
          <a href="newAccount.html" id="New_account">
            <em>Create a new account</em>
          </a>
        </div>
      </div>
    </div>

    <!-- ✅ Firebase + Login Logic -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
      import {
        getAuth,
        signInWithEmailAndPassword,
      } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js";

      // ✅ Import your Firebase config from a separate file
      import { firebaseConfig } from "./firebase-config.js";

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);

      // ✅ Wait for DOM to load
      document.addEventListener("DOMContentLoaded", () => {
        const loginButton = document.getElementById("loginButton");
        const alertBox = document.getElementById("loginAlert");

        function showAlert(message) {
          alertBox.textContent = message;
          alertBox.style.display = "block";
        }

        loginButton.addEventListener("click", () => {
          const email = document.getElementById("username").value;
          const password = document.getElementById("password").value;

          if (email === "" || password === "") {
            showAlert("⚠️ Please enter both email and password.");
            return;
          }

          signInWithEmailAndPassword(auth, email, password)
            .then((userCredential) => {
              const user = userCredential.user;
              console.log("✅ Logged in as:", user.email);
              window.location.href = "homepage.html";
            })
            .catch((error) => {
              console.error("❌ Login error:", error.message);
              showAlert("❌ " + error.message);
            });
        });
      });
    </script>
  </body>
</html>
